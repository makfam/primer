<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 N Parameters | Preceptor’s Primer for Bayesian Big Data Science</title>
<meta name="author" content="David Kane">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet">
<script src="libs/str_view-binding-1.4.0/str_view.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Preceptor’s Primer for Bayesian Big Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preamble.html">Preamble</a></li>
<li><a class="" href="shopping-week.html">Shopping Week</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">1</span> Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">2</span> Wrangling</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">3</span> Functions</a></li>
<li><a class="" href="rubin-causal-model.html"><span class="header-section-number">4</span> Rubin Causal Model</a></li>
<li><a class="" href="probability.html"><span class="header-section-number">5</span> Probability</a></li>
<li><a class="" href="one-parameter.html"><span class="header-section-number">6</span> One Parameter</a></li>
<li><a class="" href="two-parameters.html"><span class="header-section-number">7</span> Two Parameters</a></li>
<li><a class="" href="three-parameters.html"><span class="header-section-number">8</span> Three Parameters</a></li>
<li><a class="" href="building-models.html"><span class="header-section-number">9</span> Building Models</a></li>
<li><a class="" href="four-parameters.html"><span class="header-section-number">10</span> Four Parameters</a></li>
<li><a class="active" href="n-parameters.html"><span class="header-section-number">11</span> N Parameters</a></li>
<li><a class="" href="case-studies.html"><span class="header-section-number">12</span> Case Studies</a></li>
<li><a class="" href="tools.html">Tools</a></li>
<li><a class="" href="shiny.html">Shiny</a></li>
<li><a class="" href="maps.html">Maps</a></li>
<li><a class="" href="animation.html">Animation</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PPBDS/primer">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="n-parameters" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> N Parameters<a class="anchor" aria-label="anchor" href="#n-parameters"><i class="fas fa-link"></i></a>
</h1>
<!-- * Should start with  single variable which actually requires lots of parameters. For example, lived_after as a function of state and come up with a different average lived_after for each state. This is cheating in that it is too many parameters. But it would allow us to explain a bunch of stuff! Including Bayesian shrinkage. Saving this till the end of the model causes us to miss stuff. -->
<p>Having created models with one parameter in Chapter <a href="one-parameter.html#one-parameter">6</a>, two parameters in Chapter <a href="two-parameters.html#two-parameters">7</a>, three parameters in Chapter <a href="three-parameters.html#three-parameters">8</a>, and four parameters in Chapter <a href="four-parameters.html#four-parameters">10</a>, you are now ready to make the jump to <span class="math inline">\(N\)</span> parameters.</p>
<p>In this chapter, we will consider models with many parameters and the complexities that arise therefrom.</p>
<!-- DK: Add some more. What are the key lessons? What do we carry over from previous chapters? What is new? Hit the data science research cycle. -->
<div id="eda-of-governors" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> EDA of <code>governors</code><a class="anchor" aria-label="anchor" href="#eda-of-governors"><i class="fas fa-link"></i></a>
</h2>
<p>Packages:</p>
<div class="sourceCode" id="cb823"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">primer.data</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/skimr">skimr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/">rstanarm</a></span><span class="op">)</span></code></pre></div>
<!-- DK: Perhaps we need more detail in this EDA?  Explain how we only have data for people who are already dead. That is an interesting restriction, and effects the Preceptor Table in interesting ways. Or is such a discussion too advanced? -->
<!-- DK: Don't keep around variables other than the ones we end up using. -->
<!-- DK: Provide proper citation to Barfort et al. -->
<!-- DK: Go and change governors data to use better variable names than the ones we have here. Maybe switch to years instead of days. Or maybe just clean them up here. -->
<p>We will use the <code>governors</code> data set from the <strong>primer.data</strong> package. This data set features the demographic information about the candidates for governor in the US. It comes from the paper “Longevity Returns to Political Office” by Barfort, Klemmensen and Larsen (2019), which concludes that winning a gubernatorial election increases a candidate’s lifespan.</p>
<div class="sourceCode" id="cb824"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">glimpse</span><span class="op">(</span><span class="va">governors</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 1,092
## Columns: 14
## $ state        &lt;chr&gt; "Alabama", "Alabama", "Alabama", "Alabama", "Alabama", "…
## $ year         &lt;int&gt; 1946, 1946, 1950, 1954, 1954, 1958, 1962, 1966, 1966, 19…
## $ first_name   &lt;chr&gt; "James", "Lyman", "Gordon", "Tom", "James", "William", "…
## $ last_name    &lt;chr&gt; "Folsom", "Ward", "Persons", "Abernethy", "Folsom", "Lon…
## $ party        &lt;chr&gt; "Democrat", "Republican", "Democrat", "Republican", "Dem…
## $ sex          &lt;chr&gt; "Male", "Male", "Male", "Male", "Male", "Male", "Male", …
## $ died         &lt;date&gt; 1987-11-21, 1948-12-17, 1965-05-29, 1968-03-07, 1987-11…
## $ status       &lt;chr&gt; "Challenger", "Challenger", "Challenger", "Challenger", …
## $ win_margin   &lt;dbl&gt; 77.3, -77.3, 82.2, -46.7, 46.7, -77.5, 100.0, -34.3, 34.…
## $ region       &lt;chr&gt; "South", "South", "South", "South", "South", "South", "S…
## $ population   &lt;dbl&gt; 2906000, 2906000, 3058000, 3014000, 3014000, 3163000, 33…
## $ election_age &lt;dbl&gt; 38, 79, 49, 47, 46, 33, 43, 48, 40, 51, 68, 55, 45, 52, …
## $ death_age    &lt;dbl&gt; 79, 81, 63, 60, 79, 88, 79, 99, 42, 79, 75, 79, 76, 81, …
## $ lived_after  &lt;dbl&gt; 41.0, 2.1, 14.6, 13.3, 33.0, 54.5, 35.9, 51.0, 1.5, 27.9…</code></pre>
<p>There are 14 variables and 1,092 observations. In this Chapter, we will only be looking at the variables <code>last_name</code>, <code>year</code>, <code>state</code>, <code>sex</code>, <code>lived_after</code>, and <code>election_age</code>.</p>
<div class="sourceCode" id="cb826"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">&lt;-</span> <span class="va">governors</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">last_name</span>, <span class="va">year</span>, <span class="va">state</span>, <span class="va">sex</span>, <span class="va">lived_after</span>, <span class="va">election_age</span><span class="op">)</span></code></pre></div>
<p><code>election_age</code> and <code>lived_after</code> are how many days a candidate lived before the election and how many days a candidate lived after the election, respectively. As a consequence, only politicians who are already deceased are included in this data set. This means that there are only a handful of observations from elections in the last 20 years. Most candidates from that time period are still alive and are, therefore, excluded.</p>
<div class="sourceCode" id="cb827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sample_n</span><span class="op">(</span><span class="va">ch9_gov</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   last_name  year state        sex    lived_after election_age
##   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1 Ristine    1964 Indiana      Male          44.6         44.8
## 2 Sundlun    1986 Rhode Island Male          24.7         66.8
## 3 Richards   1990 Texas        Female        15.9         57.2
## 4 Turner     1946 Oklahoma     Male          26.6         52.0
## 5 Williams   1948 Michigan     Male          39.2         37.7</code></pre>
<p><code>sex</code> is most often “Male,” as we might expect.</p>
<!-- DK: Weird that this automagically creates a "TABLE 9.1: Data summary" side margin note. -->
<div class="sourceCode" id="cb829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">ch9_gov</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-629">TABLE 11.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">ch9_gov</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1092</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: character</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">last_name</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">615</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">state</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">50</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: numeric</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1965</td>
<td align="right">13.4</td>
<td align="right">1945.00</td>
<td align="right">1954</td>
<td align="right">1962</td>
<td align="right">1974</td>
<td align="right">2011</td>
<td align="left">▇▆▃▂▁</td>
</tr>
<tr class="even">
<td align="left">lived_after</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">28</td>
<td align="right">13.4</td>
<td align="right">0.13</td>
<td align="right">18</td>
<td align="right">30</td>
<td align="right">39</td>
<td align="right">60</td>
<td align="left">▃▆▇▆▂</td>
</tr>
<tr class="odd">
<td align="left">election_age</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">52</td>
<td align="right">8.7</td>
<td align="right">31.35</td>
<td align="right">45</td>
<td align="right">51</td>
<td align="right">57</td>
<td align="right">84</td>
<td align="left">▂▇▆▂▁</td>
</tr>
</tbody>
</table></div>
<p><code><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim()</a></code> groups the variables together by type. We are given histograms of the numeric data. In looking at the histogram for <code>year</code>, we see that it is skewed right — meaning that most of the data is bunched to the left and that there is a smaller tail to the right — with half of the observations from election years between 1945 and 1962. This makes sense logically, because we are only looking at deceased candidates, and candidates from more recent elections are more likely to still be alive.</p>
<p>In using this data set, our left-side variable will be <code>lived_after</code>. We are trying to understand/predict how many days a candidate will live after the election.</p>
<div class="sourceCode" id="cb830"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lived_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Gubernatorial Candidate Lifespans"</span>,
       subtitle <span class="op">=</span> <span class="st">"Candidates who died more recently can't have lived for long post-election"</span>,
       caption <span class="op">=</span> <span class="st">"Data: Barfort, Klemmensen and Larsen (2019)"</span>,
       x <span class="op">=</span> <span class="st">"Year"</span>,
       y <span class="op">=</span> <span class="st">"Days Lived After Election"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-630-1.png" width="100%"></div>
<p>Starting with the relationship between <code>lived_after</code> and <code>year</code>, we can see that there is a rough line above which there are no observations. There are no data points in the top right portion of the graph because it is not possible to have run in 2011 and then lived 20,000 days (about 55 years) after the election took place. This edge of the data represents, approximately, the most days a candidate could have possibly lived, and still have died, given the year of the election. The reason the data is slanted downward is because the maximum value for this scenario is greater in earlier years. That is, those candidates who ran for governor in earlier years could live a long time after the election and still have died prior to the data set creation, giving them higher <code>lived_after</code> values than those who ran for office in more recent years.</p>
<!-- DK: Explain why the line isn't perfect? (Because not everyone had the decency to die on the day directly before data set creation.) -->
<p>There are fewer observations in later years because fewer recent candidates have died.</p>
<div class="sourceCode" id="cb831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, y <span class="op">=</span> <span class="va">lived_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US Gubernatorial Candidate Lifespans"</span>,
       subtitle <span class="op">=</span> <span class="st">"Male candidates live much longer after the election"</span>,
       caption <span class="op">=</span> <span class="st">"Data: Barfort, Klemmensen and Larsen (2019)"</span>,
       x <span class="op">=</span> <span class="st">"Gender"</span>,
       y <span class="op">=</span> <span class="st">"Days Lived After Election"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-631-1.png" width="100%"></div>
<p>This plot shows that men live much longer, on average, than women after the election. Does that make sense to you?</p>
</div>
<div id="wisdom-5" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Wisdom<a class="anchor" aria-label="anchor" href="#wisdom-5"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span id="fig:unnamed-chunk-632"></span>
<img src="other/images/Wisdom.jpg" alt="Wisdom" width="100%"><p class="caption">
FIGURE 11.1: Wisdom
</p>
</div>
<p>The concept of the “population” is subtle and important. <em>The population is not the set of candidates for which we have data.</em> That is the data set. The population is the larger — potentially much larger — set of individuals about whom we want to make inferences. <em>The parameters in our models refer to the population, not to the data set.</em></p>
<p>Consider a simple example. Define <span class="math inline">\(\mu\)</span> as the average number of days lived by candidates for governor after Election Day. Can we calculate <span class="math inline">\(\mu\)</span> from our data? No! There are many candidates for governor who are still alive, who are not included in our data even though they are part of the “population” we want to study. <span class="math inline">\(\mu\)</span> can not be <em>calculated.</em> It can only be <em>estimated.</em></p>
<p>Note, also, that there are many different populations, each with its own <span class="math inline">\(\mu\)</span>, in which we might be interested.</p>
<!-- DK: Are these dates correct? -->
<ul>
<li><p>The population of all candidates for governor in the US from 1945 to 2012. This is the period covered in the paper.</p></li>
<li><p>The population of all candidates for governor in the US from 1900 to 2012. A priori, we would not expect a major difference between candidates who run in 1946 and those who run in 1942. How different could they be? It is therefore not unreasonable to extend the population of interest back in time, even if we have no data for earlier periods.</p></li>
<li><p>The population of all candidates for governor in the US from 1945 to 2030. We are often interested in the future. We want to make predictions about what will happen to candidates, even to candidates who have not yet run for office.</p></li>
<li><p>The population of candidates for governor around the world. Other countries have governors also! We want to understand their longevity as well.</p></li>
<li><p>The population of candidates for all political offices in the US. We might expect candidates for Senator to have similar lifespans to candidates for Governor.</p></li>
<li><p>And so on. There are as many possible populations as there are questions we might ask.</p></li>
</ul>
<p>All of these populations are different, so each has a different <span class="math inline">\(\mu\)</span>. Which <span class="math inline">\(\mu\)</span> we are interested in depends on the problem we are trying to solve. It is a judgment call, a matter of Wisdom, as to whether or not that data we have is “close enough” to the population we are interested in to justify making a model.</p>
<!-- DK: Add more? Talk about ethics? Connect to ideal Preceptor Table? -->
</div>
<div id="justice-and-courage" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Justice and Courage<a class="anchor" aria-label="anchor" href="#justice-and-courage"><i class="fas fa-link"></i></a>
</h2>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-633"></span>
<img src="other/images/Justice.jpg" alt="Justice" width="60%"><p class="caption">
FIGURE 11.2: Justice
</p>
</div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-634"></span>
<img src="other/images/Courage.jpg" alt="Courage" width="60%"><p class="caption">
FIGURE 11.3: Courage
</p>
</div>
<p>Because we will be going through a series of models in this chapter, it is useful to combine the virtues of Justice and Courage.</p>
<div id="election_age" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> election_age<a class="anchor" aria-label="anchor" href="#election_age"><i class="fas fa-link"></i></a>
</h3>
<p>To begin, let’s model candidate lifespan after the election as a function of candidate lifespan prior to the election. The data:</p>
<div class="sourceCode" id="cb832"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">election_age</span>, y <span class="op">=</span> <span class="va">lived_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Longevity of Gubernatorial Candidates"</span>,
         subtitle <span class="op">=</span> <span class="st">"Younger candidates live longer"</span>, 
         caption <span class="op">=</span> <span class="st">"Data Source: Barfort, Klemmensen and Larsen (2019)"</span>,
         x <span class="op">=</span> <span class="st">"Age in Days"</span>,
         y <span class="op">=</span> <span class="st">"Days Lived After Election"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-635-1.png" width="100%"></div>
<p>The math is fairly simple:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 alive\_pre_i + \epsilon_i \]</span></p>
<p>with <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>. <span class="math inline">\(alive\_post_i\)</span> is the number of days lived after the election for candidate <span class="math inline">\(i\)</span>. <span class="math inline">\(alive\_pre_i\)</span> is the number of days lived before the election for candidate <span class="math inline">\(i\)</span>. <span class="math inline">\(\epsilon_i\)</span> is the “error term,” the difference between the actual days-lived for candidate <span class="math inline">\(i\)</span> and the modeled days-lived. <span class="math inline">\(\epsilon_i\)</span> is normally distributed with a mean of 0 and a standard deviation of <span class="math inline">\(\sigma\)</span>. The key distinction is between:</p>
<ul>
<li><p><em>Variables</em>, always subscripted with <span class="math inline">\(i\)</span>, whose values (potentially) vary across individuals.</p></li>
<li><p><em>Parameters</em>, never subscripted with <span class="math inline">\(i\)</span>, whose values are constant across individuals.</p></li>
</ul>
<!-- DK: Better words needed. --><p><span class="math inline">\(\beta_0\)</span> is the “intercept” of the regression, the average value for the population of <span class="math inline">\(alive\_post\)</span>, among those for whom <span class="math inline">\(alive\_pre = 0\)</span>. <span class="math inline">\(\beta_1\)</span> is the “coefficient” of <span class="math inline">\(alive\_pre\)</span>. Each one day increase in <span class="math inline">\(alive\_pre\)</span> is associated with a <span class="math inline">\(\beta_1\)</span> change in <span class="math inline">\(alive\_post\)</span>. Again, this is the value for the population from which our data is drawn.</p>
<p>There are three unknown parameters — <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma\)</span> — just as with the models we used in Chapter <a href="three-parameters.html#three-parameters">8</a>.</p>
<p>You may recall from middle school algebra that the equation of a line is <span class="math inline">\(y = m x + b\)</span>. There are two parameters: <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>. The intercept <span class="math inline">\(b\)</span> is the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>. The slope coefficient <span class="math inline">\(m\)</span> for <span class="math inline">\(x\)</span> is the increase in <span class="math inline">\(y\)</span> for every increase of one in <span class="math inline">\(x\)</span>. When defining a regression line, we use slightly different notation but the fundamental relationship is the same.</p>
<p>We can use <code>geom_smooth()</code> to create the fitted regression line:</p>
<div class="sourceCode" id="cb833"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">election_age</span>, y <span class="op">=</span> <span class="va">lived_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_smooth</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Longevity of Gubernatorial Candidates"</span>,
         subtitle <span class="op">=</span> <span class="st">"Younger candidates live longer"</span>, 
         caption <span class="op">=</span> <span class="st">"Data Source: Barfort, Klemmensen and Larsen (2019)"</span>,
         x <span class="op">=</span> <span class="st">"Age in Days"</span>,
         y <span class="op">=</span> <span class="st">"Days Lived After Election"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-636-1.png" width="100%"></div>
<p>Consider someone who is about 15,000 days old on Election Day. We have a score or more data points for candidates around that age. Two died soon after the election. Some of them lived for about 5,000 days after the election. Others lived for around 20,000 days. Variation fills the world. But the fitted line tells us that, on average, we would expect a candidate that age to live for a little less than 15,000 days after the election.</p>
<!-- DK: Add a red circle to the graphic to show how we figured that out? -->
<p>This model, with a continuous independent (or “predictor”) variable, has an infinite number of fitted values, one for each possible value of <code>election_age</code>. This is very different from the models we saw in Chapter <a href="three-parameters.html#three-parameters">8</a>. Those models only had two possible fitted values because the predictor variable only took two possible values.</p>
<!-- DK: I am nervous that election_age, as used here, is a different variable that election_age when, later, we transform it.  -->
<p>We can implement this model with <code><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm()</a></code>.</p>
<div class="sourceCode" id="cb834"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">election_age</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>As we discussed in Chapter <a href="three-parameters.html#three-parameters">8</a>, the most common term for a model like this is a “regression.” We have “regressed” <code>lived_after</code>, our dependent variable, on <code>election_age</code>, our (only) independent variable.</p>
<p>The parameter values:</p>
<div class="sourceCode" id="cb835"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_1</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##              Median MAD_SD
## (Intercept)  72.6    2.0  
## election_age -0.9    0.0  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 11.1    0.2</code></pre>
<p>As is almost always the case, <span class="math inline">\(\sigma\)</span> is a nuisance parameter, somethings whose value we are not interested in. This is why <code><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm()</a></code> refers to it as an “Auxiliary” parameter.</p>
<p>The posterior distributions of <span class="math inline">\(\beta_0\)</span> (the intercept) and <span class="math inline">\(\beta_1\)</span> (the coefficient of <span class="math inline">\(alive\_pre_i\)</span>), on the other hand, are important. Before looking at the posteriors themselves, let’s examine the fitted values:</p>
<!-- DK: Use this trick to create parallel and non-parallel line plots later. -->
<div class="sourceCode" id="cb837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">election_age</span>, y <span class="op">=</span> <span class="va">lived_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">fit_gov_1</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Longevity of Gubernatorial Candidates"</span>,
         subtitle <span class="op">=</span> <span class="st">"Blue line shows fitted values"</span>, 
         caption <span class="op">=</span> <span class="st">"Data Source: Barfort, Klemmensen and Larsen (2019)"</span>,
         x <span class="op">=</span> <span class="st">"Age in Days"</span>,
         y <span class="op">=</span> <span class="st">"Days Lived After Election"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">label_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-640-1.png" width="100%"></div>
<p>This code is the same as the code we used above, except that we have replaced <code>geom_smooth()</code> with <code>geom_line()</code>. Calling <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> on a model returns the set of fitted values, which we have here plotted by hand.</p>
<!-- DK: Does this section work? If it does, we ought to do it in every chapter. If not, then why bother? It is certainly confusing to understand why sticking in the median is a good idea . . . Need to connected math to fitted values more clearly. But that might be difficult since I am hazy on how fitted values fit in a Bayesian context . . .-->
<p>We can create a formula for the fitted values by placing the median values of the parameters into the model:</p>
<p><span class="math display">\[ alive\_post_i =  26,500 - 0.9 alive\_pre_i\]</span></p>
<p>Consider the intercept. Since our independent variable is <span class="math inline">\(alive\_pre_i\)</span>, the intercept is the <span class="math inline">\(alive\_post_i\)</span> value when <span class="math inline">\(alive\_pre_i\)</span> is zero. Here, we would interpret this intercept as the average lifespan of a gubernatorial candidate after the election, if the candidate was alive for zero days prior to the election.</p>
<p>This is, of course, substantively nonsense. No one runs for office on the day they are born. In the next model, we will explore ways of making the intercept more interpretable. In the meantime, the math is the math.</p>
<p>Consider the coefficient for <span class="math inline">\(alive\_pre_i\)</span>, <span class="math inline">\(\beta_1\)</span>. The median of the posterior, -0.9, represents the slope of the model. For every unit increase in our independent variable, our dependent variable will change by this amount. For every additional day a candidate is alive before an election, their lifespan after the election will be 0.9 days lower, on average. If we are given the number of days a candidate lived before the election and want to estimate how long they will live for after, we will multiply the days they were alive prior by this beta of -0.9, and then combine that with the intercept.</p>
<p>This is a descriptive model, not a causal model. Remember our motto from Chapter <a href="rubin-causal-model.html#rubin-causal-model">4</a>: <em>No causation without manipulation.</em> There is no way, for person <span class="math inline">\(i\)</span>, to change the days that she has been alive on Election Day. On the day of this election, she is X days old. There is no way to change that. So, there are not two (or more) potential outcomes. Without more than one potential outcome, there can not be a causal effect.</p>
<p>Given that, it is important to monitor our language. We do not believe that that changes in <code>election_age</code> “cause” changes in <code>lived_after</code>. That is obvious. But there are some words and phrases — like “associated with” and “change by” — which are too close to causal. (And which we are guilty of using just a few paragraphs ago!) Be wary of their use. <em>Always think in terms of comparisons</em> when using a predictive model. We can’t change <code>election_age</code> from X to Y for an individual candidate. We can only compare two candidates (or two groups of candidates), one with <code>election_age</code> equal to X and the other with <code>election_age</code> equal to Y. If our model is correct, such candidates will, on average, differ in <code>lived_after</code> by <span class="math inline">\(\beta_1\)</span> times the difference between X and Y.</p>
<!-- DK: THis is a critical point. Maybe give a precise example? Go through the math slowly, like ModernDive does? Highlight this somehow? At the very least, we should emphasize the point for each model going forward. -->
<p>Let’s look at the posterior of <span class="math inline">\(\beta_1\)</span>, the coefficient of <span class="math inline">\(alive\_pre_i\)</span>:</p>
<!-- DK: We should standardize what these plots look like, both in this chapter and throughout the book. -->
<div class="sourceCode" id="cb838"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_1</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">election_age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Distribution of the Coefficient of `election_age`"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span>,
         x <span class="op">=</span> <span class="st">"Coefficient of `election_age`"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-641-1.png" width="100%"></div>
<!-- DK: Add some interpretation. Need to explain how the uncertainty in beta_1 is connected to the uncertainty we will see in lived_after, for a given difference (not "change") in election_age. -->
<!-- DK: Priority is to add a graphic which shows the "cloud" of possible regression lines, consistent with the posterior for beta_1.  -->
<!-- DK: Need a smoother transition back to centering. Or get rid of centering all together? -->
<!-- DK: Would using 50-year-old be better? -->
<p>We center variables when the model’s intercept does not make substantive sense. To center a model, we pick a constant value, usually the mean of the independent variable, and subtract that constant from every value of the independent variable. Another option would be to pick a reasonable reference value, like 18,262 – the number of days that a someone who is 50 years-old has lived. Either way, the meaning of <code>election_age</code> changes from the raw number of days a candidate has been alive to the number of days relative to that reference value.</p>
<p>In this example, we want to center the value for <code>election_age</code>, the independent variable. First, we must pick the value that we will center by. Here, we will use the mean of <code>election_age</code>, which is about 52 years old. Once we find this value, we will subtract it from every <code>election_age</code> value. We have, thereby, changed the meaning of <code>election_age</code>. It now means the number of days a candidate has been alive, as of Election Day, relative to the average days alive of all candidates on their respective election days.</p>
<div class="sourceCode" id="cb839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ch9_gov</span><span class="op">$</span><span class="va">election_age</span> <span class="op">&lt;-</span> <span class="va">ch9_gov</span><span class="op">$</span><span class="va">election_age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ch9_gov</span><span class="op">$</span><span class="va">election_age</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb840"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_1.centered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">election_age</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_1.centered</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##              Median MAD_SD
## (Intercept)  28.2    0.3  
## election_age -0.9    0.0  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 11.1    0.2</code></pre>
<!-- DK: If we are doing centering, then we ought to do it correctly, by showing side-by-side scatterplots with fitted lines, the better to show that we have just slid things over. -->
<p>We can see that the intercept has decreased while the slope has stayed the same. When we interpret this model, we only have to change the definition of the intercept. Rather than the intercept representing the lifespan of a candidate who was alive for zero days before running for governor, it now represents the post-election lifespan of a gubernatorial candidate who was alive for the mean number of days (about 52 years) before running. If a candidate was alive for about 52 years before running for governor, they are expected to live about 10,300 days (about 28 years) after the election, on average.</p>
<!-- DK: Really need the ideal and actual Preceptor Table for this example. And should probably present it earlier. -->
<p>Think hard about your parameters. What do they mean? Which population do they represent? What ideal Preceptor Table would make their calculation easy? In this case, <span class="math inline">\(\beta_0\)</span> is the average number of days which gubernatorial candidates live after election day, but just for the subset of candidates who are the average age on Election Day. If we had the ideal Preceptor Table, this would be trivial to calculate. Just take the average for that subset! No estimation required. But, our actual Preceptor Table has lots of missing values. In particular, many gubernatorial candidates have not . . . uh . . . died. (How inconsiderate!) So, we can’t know how many days they will live. All we can do is, first, define <span class="math inline">\(\beta_0\)</span> and, second, estimate a posterior probability distribution for it.</p>
</div>
<div id="sex" class="section level3" number="11.3.2">
<h3>
<span class="header-section-number">11.3.2</span> sex<a class="anchor" aria-label="anchor" href="#sex"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s now regress <code>lived_after</code> on <code>sex</code> to see how candidates’ post-election lifespans differ by sex.</p>
<div class="sourceCode" id="cb842"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">-</span> <span class="fl">1</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>Note this workflow. Try one model. Interpret it. Try another model. And then another. There is no one “true” model. There is an infinite space of possible models. Good data science involves an intelligent tour of that space.</p>
<div class="sourceCode" id="cb843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_2</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##           Median MAD_SD
## sexFemale 16.0    2.9  
## sexMale   28.5    0.4  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 13.3    0.3</code></pre>
<p>In this regression, we use the -1 in the formula to make the output more straightforward, with no intercept to interpret. The math of this model is the same as those we saw in Chapter <a href="three-parameters.html#three-parameters">8</a>:</p>
<p><span class="math display">\[ alive\_post_i = \beta_1 x_{f,i} + \beta_2 x_{m,i} + \epsilon_i\]</span></p>
<p>where 
<span class="math display">\[x_{f,i}, x_{m,i} \in \{0,1\}\]</span> 
<span class="math display">\[x_{f,i} +  x_{m,i} = 1\]</span> 
<span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
<!-- DK: Provide more details on what each of the items in the formula means, even though this is a repeat of what we did in chapter 8. Don't use "where" with line skips. Just one paragrpah, like elsewhere. -->
<p>The meanings of <span class="math inline">\(alive\_post_i\)</span> and <span class="math inline">\(\epsilon_i\)</span> are the same as in the first model. Indeed, they are the same throughout these exercises. <span class="math inline">\(x_{f,i}\)</span> and <span class="math inline">\(x_{m,i}\)</span> are 0/1 variables, just like last chapter. They are <em>variables</em> whose values vary across individuals.</p>
<p>The important parameters are <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. They are the average days-lived post-election for, respectively, women and men. Again, this is not the “average” for the data we have. That is easy to calculate! No estimation required. <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are averages for the entire “population,” however we have chosen to define that term. Those averages can not be calculated directly. They can only be estimated, by creating a posterior probability distribution.</p>
<p>Looking back to the regression model we just created, we see that there is no intercept. Instead of having a <span class="math inline">\(\beta_0\)</span> value, we have <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> for female and male. This makes things easier to interpret. Without having to add or subtract anything from an intercept, this regression tells us that, on average, women are expected to live about 6,000 days after running for governor, and men are expected to live 10,000 days.</p>
<p>This is a strange result. Why would men live twice as long as women after the election? One explanation for this might be that women don’t run for governor until later in life, and therefore are not expected to live as long.</p>
<!-- DK: Weird result, huh? Men live twice as long as women! Useful to discuss why that might be the case in more detail. -->
<p>Now that we have interpreted the model using a -1 in the formula to estimate <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>, let’s take away the -1 and regress <code>lived_after</code> on an intercept and <code>sex</code> to see how our equation changes.</p>
<div class="sourceCode" id="cb845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                       formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">sex</span>,
                       refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb846"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_2a</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##             Median MAD_SD
## (Intercept) 16.0    2.8  
## sexMale     12.4    2.8  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 13.3    0.3</code></pre>
<p>We no longer have a value for female. However we do have an intercept. In this regression our mathematical formula is:</p>
<p><span class="math display">\[ alive\_post_i = \beta_0  + \beta_1 x_{m,i} + \epsilon_i\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> is our intercept, around 5,850. This result is very similar to the female value from before. In this type of model, our intercept represents the the variable which is not represented in the model. <span class="math inline">\(\beta_1\)</span> only affects the outcome when the candidate is male. (If the candidate is female, then <span class="math inline">\(x_{m,i} = 0\)</span>. Therefore, the intercept value represents those who are not male, i.e., females.)</p>
<!-- DK: This explanation should be better. -->
<p>When the candidate is a male, we add the coefficient for male to the intercept value, which gives us the average lifespan of a male gubernatorial candidate after an election. As we can see from adding <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, this value is the same as what we got for males in the previous model.</p>
<p>Be careful with notation! <span class="math inline">\(\beta_1\)</span> in the no-intercept model is different from <span class="math inline">\(\beta_1\)</span> in the model with an intercept! Notation varies. We must pay attention each time we make a model.</p>
<p>The posterior distribution for <span class="math inline">\(\beta_0 + \beta_1\)</span> can be constructed via simple addition.</p>
<div class="sourceCode" id="cb848"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_2a</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>male_intercept <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">sexMale</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">male_intercept</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Distribution of Average Male Candidate Days Left`"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span>,
         x <span class="op">=</span> <span class="st">"Male Days To Live After the Election"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-649-1.png" width="100%"></div>
<p>The interpretation of this parameter is the same as we have seen before. There is a true average, across the entire population, of the number of days that male candidates live after the election. We can never know what that true average is. But, it seems highly likely that the true average is somewhere between 10,000 and 10,750 days.</p>
</div>
<div id="election_age-and-sex" class="section level3" number="11.3.3">
<h3>
<span class="header-section-number">11.3.3</span> election_age and sex<a class="anchor" aria-label="anchor" href="#election_age-and-sex"><i class="fas fa-link"></i></a>
</h3>
<p>We are going to transition to working with a model that has more than one explanatory variable. Our outcome variable will be <code>lived_after</code>, but now we will have two different explanatory variables: <code>election_age</code> and <code>sex</code>. Note that <code>sex</code> is a categorical explanatory variable and <code>election_age</code> is a continuous explanatory variable.</p>
<p>Here is the math we will be using:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i + \epsilon_i \]</span></p>
<ul>
<li><p>The outcome variable is <span class="math inline">\(alive\_post_i\)</span>, the number of days a person is alive after the election. <span class="math inline">\(male_i\)</span> is one of our explanatory variables. If we are predicting the amount of days a male candidate lives after the election, this value will be 1. When we are making this prediction for female candidates, this value will be 0. <span class="math inline">\(alive\_pre_i\)</span> is our other explanatory variable. It is the number of days a candidate has lived before the election.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all candidates (i.e. both male and female). <span class="math inline">\(\beta_0\)</span> is also the intercept of the equation. In other words, <span class="math inline">\(\beta_0\)</span> is the expected value of <span class="math inline">\(alive\_post_i\)</span>, if <span class="math inline">\(male_i = 0\)</span> and <span class="math inline">\(alive\_pre_i = 0\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is almost meaningless by itself. The only time it has meaning is when its value is connected to our intercept (i.e. <span class="math inline">\(\beta_0 + \beta_1\)</span>). When the two are added together, you get the average number of days lived after the election for men, who on the day of election, have been alive the average number of days for all candidates.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> is, for the entire population, the average difference in <span class="math inline">\(alive\_post_i\)</span> between two individuals, one of whom has an <span class="math inline">\(alive\_pre_i\)</span> value of 1 greater than the other.</p></li>
</ul>
<p>Now that we understand our model, let’s translate the following model into code.</p>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">election_age</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_3</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##              Median MAD_SD
## (Intercept)  22.1    2.4  
## sexMale       6.2    2.4  
## election_age -0.8    0.0  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 11.1    0.2</code></pre>
<p>Looking at our results, you can see that our intercept value is around 8,100. (The exact values for the median of the posterior will vary because of the random sampling inherent in fitting the model.) This means that the average female candidate, who had been alive the average number of days of all candidates, would live another 8,100 days or so after the election.</p>
<p>Note that <code>sexMale</code> is around 2,250. This is our coefficient, <span class="math inline">\(\beta_1\)</span>. We need to connect this value to our intercept value to get something meaningful. Using the formula <span class="math inline">\(\beta_0\)</span> + <span class="math inline">\(\beta_1\)</span>, we find out that the number of days the average male candidate — who, on the day of election, had been alive the average number of days of all candidate — would live is around 10,300,.</p>
<p>Now take a look at the coefficient for <span class="math inline">\(alive\_pre_i\)</span>, <span class="math inline">\(\beta_2\)</span>. The median of the posterior, -0.8, represents the slope of the model. For every unit increase in our independent variable, our dependent variable will change by this coefficient. It makes sense that this value is negative. Think about it: the more days a candidate has lived, the fewer days the candidate has left to live. So, for every extra day a candidate is alive before an election, their lifespan after the election will be 0.8 days lower, on average.</p>
<p>Let’s now look at some posteriors.</p>
<div class="sourceCode" id="cb852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_3</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>male_days <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">sexMale</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>female_days <span class="op">=</span> <span class="va">`(Intercept)`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">female_days</span>, <span class="va">male_days</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">female_days</span><span class="op">:</span><span class="va">male_days</span>, 
               names_to <span class="op">=</span> <span class="st">"parameters"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">parameters</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"Men live longer"</span>,
         x <span class="op">=</span> <span class="st">"Average Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-652-1.png" width="100%"></div>
<!-- DK: Much more to say here, and say it clearly! -->
<p>The graph above displays the posterior probability distributions for <span class="math inline">\(\beta_0\)</span> and for $_0 + _1 $. The two distributions are fairly different; the distribution for females is more spread out than that for males. There were a greater number of men than women in the data. The more data we have, the more precise we can be.</p>
<p>Let’s now take a look at a posterior distribution for <span class="math inline">\(\beta_2\)</span>, the coefficient of <span class="math inline">\(alive\_pre_i\)</span>.</p>
<div class="sourceCode" id="cb853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_3</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">election_age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Distribution of the Coefficient of `election_age`"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span>,
         x <span class="op">=</span> <span class="st">"Coefficient of `election_age`"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/fit_gov3-p1-1.png" width="100%"></div>
<!-- DK: Need some commentary here. -->
<!-- DK: Show three posterior plots: one for beta_2, one for beta_0 (intercept) and one for beta_0 + beta_1.  Interpret them. This is a parallel slopes model. Can we show a parallel slopes graph by hand? Skip this for now. -->
<!-- DK: Cool, eh? It is (mostly?) an age effect! Controlling for age at the election, women live about as long as men, but they are much more likely be candidates as an older age. Again, what we are doing is slowly building more complex models, understanding what they mean. -->
<!-- Also, note that this is a "parallel slopes" model. Explain slowly what that means.  Create a plot. -->
<!-- Side note: I would have thought that overlapping CIs for male/female would equate to insignificance of sex dummy when the regression includes a intercept. But that does not seem to be the case. Am I missing something? -->
<!-- Make the graphic which shows two parallel lines, by calling two layers of geom_smooth().  -->
<!-- With this as warm-up, we are now in a position to explore interactions. -->
</div>
<div id="election_age-sex-and-election_agesex" class="section level3" number="11.3.4">
<h3>
<span class="header-section-number">11.3.4</span> election_age, sex and election_age*sex<a class="anchor" aria-label="anchor" href="#election_age-sex-and-election_agesex"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s create another model. This time, however, the numeric outcome variable of lived_after as a function of the two explanatory variables we used above, <code>election_age</code> and <code>sex</code>, and of their interaction.</p>
<p>Math:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i + \\ \beta_3 male_i *  alive\_pre_i + \epsilon_i\]</span>
<!-- DK: Need to make these interpretations clearer and more consistent across the examples. --></p>
<ul>
<li><p>Our outcome variable is still <span class="math inline">\(alive\_post_i\)</span>. We want to know how many days a candidate will live after an election.</p></li>
<li><p><span class="math inline">\(male_i\)</span> is still one of our explanatory variables. If we are predicting the amount of days a male candidate lives after the election, this will be 1. When we are making this prediction for female candidate, this will be 0. <span class="math inline">\(alive\_pre_i\)</span> is still our other explanatory variable, representing the number of days a candidate has lived before the election, relative to the average value for all candidates.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all candidates. In a sense, this is the same meaning as in the previous model, without an interaction term. But, always remember that the meaning of a parameter is conditional on the model in which it is embedded. Even if a parameter is called <span class="math inline">\(\beta_0\)</span> in two different regressions does necessitate that it means the same thing in both regressions. Parameter names are arbitrary, or at least simply a matter of convention.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> does not have a simple interpretation as a stand-alone parameter. It is a measure of how different women are from men. However, <span class="math inline">\(\beta_0 + \beta_1\)</span> has a straightforward meaning exactly analogous to the meaning of <span class="math inline">\(\beta_0\)</span>. The sum is the average number of days lived after the election for <em>men</em>, who on the day of election, have been alive the average number of days of all candidates.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> is the coefficient of <span class="math inline">\(alive\_pre_i\)</span>. It it just the slope for women. It is the average difference in <span class="math inline">\(alive\_post_i\)</span> between two women, one of whom has an <span class="math inline">\(alive\_pre_i\)</span> value of 1 greater than the other. In our last example, <span class="math inline">\(\beta_2\)</span> was the slope for the whole population. Now we are different slopes for different genders.</p></li>
<li><p><span class="math inline">\(\beta_3\)</span> alone is difficult to interpret. However, when it is added to <span class="math inline">\(\beta_2\)</span>, the result in the slope for men.</p></li>
</ul>
<p>Code:</p>
<div class="sourceCode" id="cb854"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">sex</span><span class="op">*</span><span class="va">election_age</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_4</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##                      Median MAD_SD
## (Intercept)          16.6    3.6  
## sexMale              11.7    3.6  
## election_age         -0.1    0.4  
## sexMale:election_age -0.8    0.4  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 11.1    0.2</code></pre>
<!-- DK: Take your time explaining what this means! It is not trivial. Note that this is a non-parallel slopes model. -->
<p>The intercept has increased. <span class="math inline">\(\beta_0\)</span> is around 6,000. This is the intercept for females. It still means the average number of days lived after the election for women is 6,000 or so. Our <code>sexMale</code> coefficient, <span class="math inline">\(\beta_1\)</span>, refers to the value that must be added to the intercept in order to get the intercept for males. When calculated, the result is 10,000. Keep in mind, however, that these values only apply if <span class="math inline">\(alive\_pre_i = 0\)</span>, if, that is, candidate <span class="math inline">\(i\)</span> is around 52 years old.</p>
<p>The coefficient for <span class="math inline">\(alive\_pre_i\)</span>, <span class="math inline">\(\beta_2\)</span>, is -0.1. What does this mean? It is the slope for females. So for every extra day a female candidate is alive before an election, their lifespan after the election will be 0.1 days lower, on average. Now direct your attention below at the coefficient of <code>sexMale:election_age</code>, <span class="math inline">\(\beta_3\)</span>, which is -.8. This is the value that must be added to the coefficient of <span class="math inline">\(alive\_pre_i\)</span> (recall <span class="math inline">\(\beta_2\)</span> + <span class="math inline">\(\beta_3\)</span>) in order to find the slope for males. When the two are added together, this value, or slope, is about -0.9. For every extra day a male candidate is alive before an election, their lifespan after the election will be 0.9 days lower, on average.</p>
<p><em>Key point</em>: The interpretation of the intercepts only apply to candidates for whom <span class="math inline">\(alive\_pre_i = 0\)</span>. Candidates who are not 52 years-old will have different expected number of days to live. The interpretation of the slope applies to everyone. In other words, the relationship between <span class="math inline">\(alive\_post_i\)</span> and <span class="math inline">\(alive\_pre_i\)</span> is the same, regardless of your gender or how old you are.</p>
<p>The posterior:</p>
<div class="sourceCode" id="cb857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_4</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>male_days <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">sexMale</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>female_days <span class="op">=</span> <span class="va">`(Intercept)`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">female_days</span>, <span class="va">male_days</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">female_days</span><span class="op">:</span><span class="va">male_days</span>, 
               names_to <span class="op">=</span> <span class="st">"parameters"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">parameters</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"Men live longer"</span>,
         x <span class="op">=</span> <span class="st">"Average Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-655-1.png" width="100%"></div>
<p>Male candidates live longer on average than female candidates. Note, also, that the average days to live after the election for females is about 6,000 with this model. With the previous model, it was 8,000. Why the difference? The interpretation of “average” is different! In the previous model, it was the average for all women. In this model, it is the average for all 52 years-old women. Those are different things, so we should hardly be surprised by different posteriors.</p>
<!-- DK: Is the above right? -->
<p>Slope posteriors:</p>
<div class="sourceCode" id="cb858"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_4</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>slope_men <span class="op">=</span> <span class="va">election_age</span> <span class="op">+</span> <span class="va">`sexMale:election_age`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>slope_women <span class="op">=</span> <span class="va">election_age</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">slope_women</span>, <span class="va">slope_men</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">slope_women</span><span class="op">:</span><span class="va">slope_men</span>, 
               names_to <span class="op">=</span> <span class="st">"parameters"</span>,
               values_to <span class="op">=</span> <span class="st">"slope"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">slope</span>, fill <span class="op">=</span> <span class="va">parameters</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"Men have a steeper slope"</span>,
         x <span class="op">=</span> <span class="st">"slope"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-656-1.png" width="100%"></div>
<p>This posterior distribution shows the average slope values for men and women. You can see that men have a steeper slope, while the slope for women is practically 0! <em>If you are trying to forecast the number of days that a women will live after the election, you may ignore the number of days that she has already lived.</em> This is definitely not true for men. Why the difference?</p>
<!-- DK: Answer this question!  -->
</div>
<div id="what-is-beta_0" class="section level3" number="11.3.5">
<h3>
<span class="header-section-number">11.3.5</span> What is <span class="math inline">\(\beta_0\)</span>?<a class="anchor" aria-label="anchor" href="#what-is-beta_0"><i class="fas fa-link"></i></a>
</h3>
<p>Attentive readers will have noticed that the meaning of <span class="math inline">\(\beta_0\)</span> is identical for the last two models and, at the same time, our estimate for its posterior are very different. How can that be?</p>
<p>Recall the math:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i + \epsilon_i \]</span></p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \beta_1 male_i + \beta_2 alive\_pre_i + \\ \beta_3 male_i *  alive\_pre_i + \epsilon_i\]</span>
In both cases, <span class="math inline">\(\beta_0\)</span> has the same meaning. It is the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all candidates. Plug in 0 for <span class="math inline">\(male_i\)</span> and 0 for <span class="math inline">\(alive\_pre_i\)</span> and both equations simplify to:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 + \epsilon_i \]</span>
So far, so good. But, despite the fact that we are using the same data, the posterior probability distributions for <span class="math inline">\(\beta_0\)</span> are meaningfully different between the two models:</p>
<div class="sourceCode" id="cb859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m_3</span> <span class="op">&lt;-</span> <span class="va">fit_gov_3</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`(Intercept)`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>`No Interaction Term` <span class="op">=</span> <span class="va">`(Intercept)`</span><span class="op">)</span>

<span class="va">m_4</span> <span class="op">&lt;-</span> <span class="va">fit_gov_4</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`(Intercept)`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>`With Interaction Term` <span class="op">=</span> <span class="va">`(Intercept)`</span><span class="op">)</span>

<span class="fu">bind_cols</span><span class="op">(</span><span class="va">m_3</span>, <span class="va">m_4</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`No Interaction Term`</span>, <span class="va">`With Interaction Term`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">`No Interaction Term`</span><span class="op">:</span><span class="va">`With Interaction Term`</span>, 
               names_to <span class="op">=</span> <span class="st">"Model"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distributions"</span>,
         subtitle <span class="op">=</span> <span class="st">"For intercept in two different models"</span>,
         x <span class="op">=</span> <span class="st">"Additional Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-657-1.png" width="100%"></div>
<p>There is enough overlap between the two distributions that they aren’t completely incompatible. If, in truth, <span class="math inline">\(\beta_0 = 7000\)</span>, neither posterior distribution is “wrong.”</p>
<p>The meaning of any parameter, including <span class="math inline">\(\beta_0\)</span>, is conditional on two assumptions: the population for which we seek to make inferences and the structure of the model. In this case, we assume that the population of interest is the same. But the models are different, albeit only by one interaction term. But that is enough of a difference to make <span class="math inline">\(\beta_0\)</span> in the first model a different “thing” that <span class="math inline">\(\beta_0\)</span> in the second model, even if one “interpretation” of what they mean is the same.</p>
<p>The trick is that an individual interpretation of the meaning of a parameter just captures one characteristic of the meaning of that parameter. It is just a single view of the “thing.” That view is fine, as far as it goes, but it can’t show us all aspects of the parameter. A picture of the full moon tells us little about what appears on its dark side.</p>
<p>Consider a different question: What is the expected value for male candidates who are 1 year older than average:</p>
<ul>
<li><p>Without an interaction term: <span class="math inline">\(\beta_0 + \beta_1 + \beta_2 365\)</span>.</p></li>
<li><p>With an interaction term: <span class="math inline">\(\beta_0 + \beta_1 + \beta_2 365 + \beta_3 365\)</span>.</p></li>
</ul>
<p>We shouldn’t be surprised that different models generate different formulas for this question. Yet note how <span class="math inline">\(\beta_0\)</span> appears in both. In other words, <span class="math inline">\(\beta_0\)</span> is not <em>only</em> the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all candidates. It is also part of a multitude of other estimates.</p>
<p><em>The only way to understand all of what is wrapped up in <span class="math inline">\(\beta_0\)</span> is to see it in the context of the full mathematical formula.</em> Since we have two different models, defined by two different formulas, it is hardly surprising that the posterior probability distributions for <span class="math inline">\(beta_0\)</span> will differ, even though one specific interpretation — one out of many — is the same.</p>
<p>Our advice: Spend less time thinking about what parameters <em>mean</em> and more time using <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code> and <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> to examine the implications of your models. Those posteriors are the real substance of your model.</p>
</div>
<div id="state-election_age-sex-and-election_agesex" class="section level3" number="11.3.6">
<h3>
<span class="header-section-number">11.3.6</span> state, election_age, sex and election_age*sex<a class="anchor" aria-label="anchor" href="#state-election_age-sex-and-election_agesex"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s leave aside subtleties of parameter interpretation and consider one more model, one very similar to the one we just created. We are now adding “state,” which will give us 55 different intercepts!</p>
<p>Math:</p>
<p><span class="math display">\[ alive\_post_i =  \beta_0 +  \beta_1 x_{AK,i} + \beta_2 x_{AR,i} + ... \beta_{49} x_{WY,i} + \\
\beta_{50} male_i + \beta_{51} alive\_pre_i+ \beta_{52} male_i *  alive\_pre_i + \epsilon_i\]</span></p>
<!-- DK: Clean this up. Explain meaning of intercept more clearly. -->
<ul>
<li><p><span class="math inline">\(alive\_post_i\)</span> is the outcome variable. <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>… all the way to <span class="math inline">\(\beta_{49}\)</span> correspond to different parameters. These values are specific to each state. In order to find the female intercept (i.e. lived_after for females) for a specific state, you must add that state’s beta value to the value of <span class="math inline">\(\beta_0\)</span> to find intercept for the <code>lived_after</code> outcome for females candidates in that specific state. For example, if you look at the model above, <span class="math inline">\(\beta_1\)</span> is the intercept value for Arkansas (note the AK subscript). You would take the appropriate value, which appears next to Arkansas in the printed model, and add it to the value for <span class="math inline">\(\beta_0\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> will be the intercept for one state alone. When the model is printed, you will see that (Intercept) takes on the lived_after value for female candidates in Alabama.</p></li>
<li><p><span class="math inline">\(\beta_{50}\)</span> is the coefficient for the explanatory variable <span class="math inline">\(male_i\)</span>. When we are trying to find the intercepts for female candidates, the explanatory variable will take on the value of 0. However, <span class="math inline">\(male_i\)</span> = 1 when we are trying to find intercept values for male candidates. Therefore, you add the <span class="math inline">\(\beta_{50}\)</span> value to the female intercept value to find the value of lived_after for male candidates. <span class="math inline">\(\beta_{51}\)</span> is the coefficient for the explanatory variable <span class="math inline">\(alive\_pre_i\)</span>. It it just the slope for women. <span class="math inline">\(\beta_{52}\)</span> is difficult to interpret. However, it gains meaning when it is added to <span class="math inline">\(\beta_{51}\)</span>, which results in the slope for men.</p></li>
</ul>
<div class="sourceCode" id="cb860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ch9_gov</span>,
                      formula <span class="op">=</span> <span class="va">lived_after</span> <span class="op">~</span> <span class="va">state</span> <span class="op">+</span> <span class="va">sex</span><span class="op">*</span><span class="va">election_age</span>,
                      refresh <span class="op">=</span> <span class="fl">0</span>,
                      iter <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></code></pre></div>
<p>Note it takes awhile to run. We are dealing with 55 parameters here.</p>
<div class="sourceCode" id="cb861"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit_gov_5</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##                      Median MAD_SD
## (Intercept)          13.5    4.1  
## stateAlaska           2.9    3.9  
## stateArizona          7.9    3.2  
## stateArkansas         1.3    3.2  
## stateCalifornia       5.4    3.5  
## stateColorado         4.0    3.4  
## stateConnecticut      2.7    3.5  
## stateDelaware         8.4    3.5  
## stateFlorida         -4.3    3.7  
## stateGeorgia          4.7    3.8  
## stateHawaii           4.3    4.2  
## stateIdaho            4.6    3.4  
## stateIllinois        -0.5    3.7  
## stateIndiana          3.3    3.5  
## stateIowa             2.5    3.2  
## stateKansas          -0.5    3.2  
## stateKentucky         4.0    3.6  
## stateLouisiana        3.8    4.0  
## stateMaine            5.7    3.6  
## stateMaryland         4.5    3.5  
## stateMassachusetts    0.1    3.2  
## stateMichigan        -3.3    3.3  
## stateMinnesota        4.4    3.3  
## stateMississippi      2.0    3.6  
## stateMissouri         1.2    3.6  
## stateMontana          2.2    3.5  
## stateNebraska         2.1    3.3  
## stateNevada           4.1    3.7  
## stateNew Hampshire    3.5    3.2  
## stateNew Jersey       0.9    3.6  
## stateNew Mexico       2.7    3.1  
## stateNew York         2.3    3.4  
## stateNorth Carolina  -4.1    3.9  
## stateNorth Dakota     5.8    3.3  
## stateOhio             5.9    3.3  
## stateOklahoma        -1.7    3.7  
## stateOregon           0.5    3.4  
## statePennsylvania     3.4    3.5  
## stateRhode Island     5.2    3.0  
## stateSouth Carolina   6.6    3.8  
## stateSouth Dakota    -5.2    3.2  
## stateTennessee       -1.3    3.5  
## stateTexas            3.2    3.2  
## stateUtah             3.2    3.4  
## stateVermont          1.5    3.2  
## stateVirginia         6.9    3.9  
## stateWashington       7.5    3.5  
## stateWest Virginia    6.5    3.5  
## stateWisconsin        6.6    3.2  
## stateWyoming         -1.5    3.5  
## sexMale              12.1    3.6  
## election_age          0.0    0.4  
## sexMale:election_age -0.8    0.4  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 10.8    0.2</code></pre>
<p>The (Intercept) refers to the average number of days lived after the election for women, who on the day of election, have been alive the average number of days of all female candidates in Alabama! That’s a mouthful. It really is not different than what we have been doing all along, however. You can see here that (Intercept) value is around 4,900.</p>
<p>However, we have only talked about women. What about for the men? Well, if you look at the bottom of the list, you will see the <code>sexMale</code> value of around 4,400. When you wish to find lived_after for a specific state, you must add this value to the intercept, about 4,900, and then also add the intercept of the desired state.</p>
<p><span class="math inline">\(\beta_{51}\)</span>, our coefficient value for <span class="math inline">\(alive\_pre_i\)</span>, is 0. This means women have a slope of 0.</p>
<!-- DK: Conflict between $alive\_pre_i$ and `sexMale:election_age`. Which is better? Should be consistent. -->
<p><span class="math inline">\(\beta_{51}\)</span> + <span class="math inline">\(\beta_{52}\)</span>, our coefficients for <span class="math inline">\(alive\_pre_i\)</span> and <code>sexMale:election_age</code>, results in the value of around -0.8. This value is our slope for men.</p>
<p>Posterior distribution for female candidates in Washington and South Dakota.</p>
<!-- DK: Clean up math here. No hard coding numbers!-->
<div class="sourceCode" id="cb863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_5</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Washington_females <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">stateWashington</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span> <span class="op">(</span>SD_females <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">`stateSouth Dakota`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Washington_females</span>, <span class="va">SD_females</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Washington_females</span><span class="op">:</span><span class="va">SD_females</span>, 
               names_to <span class="op">=</span> <span class="st">"parameters"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">parameters</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"for women that live in Washington and South Dakota"</span>,
         x <span class="op">=</span> <span class="st">"Average Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-660-1.png" width="100%"></div>
<p>The posterior above shows that female candidates in Washington live longer after the election than female candidates in South Dakota. Interesting huh? Our knowledge about averages is always more precise than our knowledge about individuals.</p>
<!-- DK: Need to modify this to only show one of the more interesting state coefficients. (Although we might show all the state pdfs in the graphic.) This a good place to discuss shrinkage, which is what is happening here. And that is probably enough models. -->
</div>
</div>
<div id="temperance-5" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Temperance<a class="anchor" aria-label="anchor" href="#temperance-5"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span id="fig:unnamed-chunk-661"></span>
<img src="other/images/Temperance.jpg" alt="Temperance" width="100%"><p class="caption">
FIGURE 11.4: Temperance
</p>
</div>
<p>Consider:</p>
<ul>
<li>How long will two male political candidates — one from South Dakota and one from Washington, both 10 years older than the average candidate — live after the election? How different will their lifespans be?</li>
</ul>
<p>These questions are, purposely, less precise than the ones we tackled in Chapters <a href="two-parameters.html#two-parameters">7</a> and <a href="three-parameters.html#three-parameters">8</a>, written more in a conversational style. This is how normal people talk.</p>
<p>However, as data scientists, our job is to bring precision to these questions. There are two commonsense interpretations. First, we could be curious about the <em>expected values</em> for these questions. If we averaged the data for a thousand candidates like these, what would the answer be? Second, we could be curious about two specific individuals. How long will they live? <em>Averages involve questions about parameters. The fates of individuals require predictions.</em> Those are general claims, violated too often to be firm rules. Yet, they highlight a key point: <em>expected values are less variable than individual predictions</em>.</p>
<p>To calculate expected values, use parameters and algebra. To forecast for individuals, use <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code>.</p>
<div id="expected-values" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> Expected Values<a class="anchor" aria-label="anchor" href="#expected-values"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the “on average” interpretation first. The answer begins with the posterior distributions of the parameters in <code>fit_gov_5</code>.</p>
<!-- DK: We need to walk through the math. Start with the original formula. Replace the x's with the values for this person. Simplify. Plug in the parameters, which are distributions. This gives us the answer. It goes too fast to just go straight for the code. -->
<div class="sourceCode" id="cb864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_5</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>WA <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">stateWashington</span> <span class="op">+</span> <span class="va">sexMale</span> <span class="op">+</span> 
           <span class="op">(</span><span class="va">`sexMale:election_age`</span> <span class="op">+</span> <span class="va">election_age</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>SD <span class="op">=</span> <span class="va">`(Intercept)`</span> <span class="op">+</span> <span class="va">`stateSouth Dakota`</span> <span class="op">+</span> <span class="va">sexMale</span> <span class="op">+</span> 
           <span class="op">(</span><span class="va">`sexMale:election_age`</span> <span class="op">+</span> <span class="va">election_age</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">WA</span>, <span class="va">SD</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">WA</span><span class="op">:</span><span class="va">SD</span>, 
               names_to <span class="op">=</span> <span class="st">"Parameter"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"For 62 years-old male candidates from South Dakota and Washington"</span>,
         x <span class="op">=</span> <span class="st">"Expected Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-662-1.png" width="100%"></div>
<p>Looking at our posterior probability distributions above, we can see that the candidates from Washington are expected to live longer. But how much longer? As in previous chapters, we can manipulate distributions in, more or less, the same way that we manipulate simple numbers. If we want to know the difference between two posterior distributions, we can simply subtract. But before we do, note that, in many ways, looking at the difference is much easier than considering the individual posteriors.</p>
<p>We don’t really need to calculate <code>WA</code> using all those complex terms. We already know that we are going to subtract <code>SD</code> and that both <code>WA</code> and <code>SD</code> include the <code>(Intercept)</code>, <code>sexMale</code>, and so on. All those terms in common will cancel out when we subtract. So, we can go directly to <code>diff</code> being equal to the difference between <code>stateWashington</code> and <code>stateSouth Dakota</code>.</p>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_gov_5</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">stateWashington</span> <span class="op">-</span> <span class="va">`stateSouth Dakota`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"Candidates from Washington live longer than those from South Dakota"</span>,
         x <span class="op">=</span> <span class="st">"Average Additional Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-663-1.png" width="100%"></div>
<p>The average value of the difference in days-to-live is almost certainly positive, with the most likely value being around 4,500. Notice that there is essentially zero chance that, on average, South Dakota candidates live longer.</p>
<p>One annoyance of the above approach is that it requires us to do everything “by hand,” to recall the mathematical structure of the model, and then to insert the relevant values of the data for the individuals we want to predict. What a bother! Fortunately, <strong>rstanarm</strong> provides the <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code> function to make this process simpler.</p>
<p>First, we create a tibble with the desired input for our model. In our case the tibble has a variable named <code>sex</code> which contains two observations both with the value “Male.” There is a <code>state</code> variable with the desired states. There is an <code>election_age</code> variable set to 10 years worth of days.</p>
<div class="sourceCode" id="cb866"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_obs</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Male"</span><span class="op">)</span>,
                  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"South Dakota"</span>, <span class="st">"Washington"</span><span class="op">)</span>,
                  election_age <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span></code></pre></div>
<p>Second, we pass the fitted model object and this tibble to <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code>.</p>
<div class="sourceCode" id="cb867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred</a></span><span class="op">(</span><span class="va">fit_gov_5</span>, 
                      newdata <span class="op">=</span> <span class="va">new_obs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p>The name <code>pe</code> stands for <strong>p</strong>osterior <strong>e</strong>xpectation. This is different from the <strong>p</strong>osterior <strong>p</strong>rediction which <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> produces. Transforming the resulting object into a tibble makes later graphing easier. With <code>pe</code>, we can now reproduce our last two plots much more easily.</p>
<div class="sourceCode" id="cb868"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pe</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>SD <span class="op">=</span> <span class="va">`1`</span>,
         WA <span class="op">=</span> <span class="va">`2`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Difference <span class="op">=</span> <span class="va">WA</span> <span class="op">-</span> <span class="va">SD</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">SD</span><span class="op">:</span><span class="va">Difference</span>, 
               names_to <span class="op">=</span> <span class="st">"Parameter"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"For 62 years-old candidates from South Dakota and Washington"</span>,
         x <span class="op">=</span> <span class="st">"Expected Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-666-1.png" width="100%"></div>
<!-- What an interesting plot! -->
</div>
<div id="individual-predictions" class="section level3" number="11.4.2">
<h3>
<span class="header-section-number">11.4.2</span> Individual Predictions<a class="anchor" aria-label="anchor" href="#individual-predictions"><i class="fas fa-link"></i></a>
</h3>
<p>If, instead, we interpret the question as asking for a prediction for a small number of individuals, then we need to use <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code>.</p>
<!-- DK: Try again to explain what a posterior prediction is. -->
<p>Use <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> to create draws from the posterior probability distribution for our prediction for these cases. <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> takes two arguments: the model for which the simulations should be run, and a tibble indicating the covariate values for the individual(s) we want to predict. In this case, we are using the <code>fit_gov_5</code> model and the tibble is the one we just created above. In other words, the inputs for <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> and <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code> are identical.</p>
<div class="sourceCode" id="cb869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit_gov_5</span>, 
                        newdata <span class="op">=</span> <span class="va">new_obs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="va">as.numeric</span><span class="op">)</span>
  
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##      `1`    `2`
##    &lt;dbl&gt;  &lt;dbl&gt;
## 1 -3219. -3195.
## 2 -3353. -3340.
## 3 -3066. -3070.
## 4 -3121. -3102.
## 5 -3190. -3170.
## 6 -2970. -2948.</code></pre>
<p>The resulting tibble has 2 columns, one for each person. The first column shows the posterior predictions for the candidate from South Dakota. The second column shows the posterior predictions for the candidate from Washington. In both cases, the forecasts depend on the values of all the covariates. That is, we would provide a different forecast if the candidates were female or if they were other ages.</p>
<p>Why do we need the weird <code>mutate_all(as.numeric)</code> incantation? The reason is that <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code> returns a simple matrix, which is easy to transform into a tibble. <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code>, on the other hand, returns a special sort of matrix which is much harder to work with. So, we need a little hackery to make the next steps easier.</p>
<p>Let’s look at the posterior predictive distribution for each candidate.</p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pp</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>SD <span class="op">=</span> <span class="va">`1`</span>,
         WA <span class="op">=</span> <span class="va">`2`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">SD</span><span class="op">:</span><span class="va">WA</span>, 
               names_to <span class="op">=</span> <span class="st">"State"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Predictive Distribution"</span>,
         subtitle <span class="op">=</span> <span class="st">"For 62 years-old male candidates from South Dakota and Washington"</span>,
         x <span class="op">=</span> <span class="st">"Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-668-1.png" width="100%"></div>
<p>There is a big overlap in the predictions for individuals, even though there is almost no overlap in the averages. Random stuff happens to an individual all the time. Random stuff cancels out when you take the average for many individuals. Consider the difference in the posterior predictive distributions for the two individuals.</p>
<!-- DK: Example "Posterior Predictive Distribution" -->
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pp</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">`2`</span> <span class="op">-</span> <span class="va">`1`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Predictive Distribution"</span>, 
         subtitle <span class="op">=</span> <span class="st">"How much longer will an individual Washington candidate live?"</span>,
         x <span class="op">=</span> <span class="st">"Days"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-669-1.png" width="100%"></div>
<p>In words, we would predict that the candidate from Washington would live longer than the South Dakota candidate. By how much? Well, that number is an unknown parameter. By looking at our posterior above, our best estimate is about 4,500 days, which is roughly 8 years. However, it is important to note that it is possible that the male from South Dakota could outlive the Washington male. In fact, there is a 1 in 5 chance that he does so.</p>
<p><em>Note what is the same and what is different when we move from a question about averages to a question about individuals.</em> In both cases, the most likely value is about the same, about 4,500 days. That is, the average behavior is the same as our expected value for any given individual. But the uncertainty is much greater for an individual prediction. The chance of the true average for Washington candidates being less than that for South Dakota candidates is essentially zero. Yet, for any individual pair of candidates, it would not even be slightly surprising for the South Dakota candidate to outlive the Washington candidate. Individuals vary. Averages never tell the whole story.</p>
</div>
<div id="expectation-versus-individual-variation" class="section level3" number="11.4.3">
<h3>
<span class="header-section-number">11.4.3</span> Expectation versus individual variation<a class="anchor" aria-label="anchor" href="#expectation-versus-individual-variation"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s compare the results from <code><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred()</a></code> and <code><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict()</a></code> for this scenario directly. Most of this code is the same as what we have shown you above, but we think it is useful to look at everything together.</p>
<div class="sourceCode" id="cb873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_obs</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Male"</span><span class="op">)</span>,
                  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"South Dakota"</span>, <span class="st">"Washington"</span><span class="op">)</span>,
                  election_age <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span>

<span class="va">pe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/posterior_linpred.stanreg.html">posterior_epred</a></span><span class="op">(</span><span class="va">fit_gov_5</span>, 
                      newdata <span class="op">=</span> <span class="va">new_obs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">`2`</span> <span class="op">-</span> <span class="va">`1`</span><span class="op">)</span>

<span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit_gov_5</span>, 
                        newdata <span class="op">=</span> <span class="va">new_obs</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate_all</span><span class="op">(</span><span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">`2`</span> <span class="op">-</span> <span class="va">`1`</span><span class="op">)</span>

<span class="fu">tibble</span><span class="op">(</span>Expectation <span class="op">=</span> <span class="va">pe</span><span class="op">$</span><span class="va">diff</span>,
       Prediction <span class="op">=</span> <span class="va">pp</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Expectation</span><span class="op">:</span><span class="va">Prediction</span>, 
               names_to <span class="op">=</span> <span class="st">"State"</span>,
               values_to <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">days</span>, fill <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">count</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.5</span>, 
                   bins <span class="op">=</span> <span class="fl">100</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior Probability Distributions"</span>,
         subtitle <span class="op">=</span> <span class="st">"For 62 years-old male candidates from South Dakota and Washington"</span>,
         x <span class="op">=</span> <span class="st">"Additional Days Lived Post Election"</span>,
         y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">number_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-670-1.png" width="100%"></div>
<p>Expected values vary much less than predictions. The above chart makes that easy to see. We can be almost certain that the true underlying average for the numbers of days that Washington candidates live longer than South Dakota candidates is positive. But, for any two individual candidates, there is a good chance that that the South Dakota candidate will live longer. We can not ignore <span class="math inline">\(\epsilon\)</span> when predicting the outcome for individuals. When estimating expected values or long-run averages, the <span class="math inline">\(\epsilon\)</span>’s cancel out.</p>
<!-- DK: Discuss the substantive issue? How can it be that Washington candidates live longer? Also, compare these estimates to what naive lm() would tell us. -->
<!-- DK: Finish with Temperance/population/exchangability discussion. -->
</div>
<div id="testing" class="section level3" number="11.4.4">
<h3>
<span class="header-section-number">11.4.4</span> Testing<a class="anchor" aria-label="anchor" href="#testing"><i class="fas fa-link"></i></a>
</h3>
<p>In a normal statistics book, we would have already discussed the concept of “testing” extensively. The terminology varies by field. “Tests,” “testing,” “hypothesis tests,” “tests of significance,” and “null hypothesis significance testing” all refer to the same concept. We will refer to this collection of approaches as NHST, a common abbreviation derived from the initials of the last phrase. Wikpedia provides an <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">overview</a>.</p>
<p><em>Our view: Amateurs test. Professionals summarize.</em></p>
<p>Consider the question of the expected difference in lifespans for our South Dakato and Washington candidates. Is that difference “significant?” Can we “reject the null hypothesis?” The convential answer is Yes. Anytime that zero is outside of the 95% confidence interval, we can declare the result significant. But why should we? What does that gain us? We already have the full posterior probability distribution. That is knowledge. A Yes/No question throws away too much information to (almost) ever be useful. There is no reason to <em>test</em> when you can <em>summarize</em> by providing the full posterior probability distribution.</p>
<p>The same arguments apply in the case of “insignificant” results, with “<span class="math inline">\(p &gt; 0.5\)</span>, when we can’t”reject" the null hypothesis. Instead of expected values, consider the case of two candidates, one from South Dakota and one from Washington. Is the difference in their predicted lifespans “significant?” Who cares!? We have the full posterior probability distribution for that prediction — also known as the posterior predictive distribution — as graphed above. The 95% confidence interval includes zero. Does that mean we should throw it away? No! That would be nonsense. Yes, there is a 20% chance that the South Dakota candidate lives longer, so we can hardly be surprised when that happens. But we still think that it is much more likely that the Washington candidate lives longer. Indeed, we would consider 4-to-1 odds as fair. The fact that the difference is not “significant” has no relevance to how we use the posterior to make decisions.</p>
<p>The same reasoning applies to every parameter we estimate, to every prediction we make. Never test — unless your boss demands a test. <em>Use your judgment, make your models, summarize your knowledge of the world, and use that summary to make decisions.</em></p>
</div>
</div>
<div id="summary-6" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-6"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="four-parameters.html"><span class="header-section-number">10</span> Four Parameters</a></div>
<div class="next"><a href="case-studies.html"><span class="header-section-number">12</span> Case Studies</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#n-parameters"><span class="header-section-number">11</span> N Parameters</a></li>
<li><a class="nav-link" href="#eda-of-governors"><span class="header-section-number">11.1</span> EDA of governors</a></li>
<li><a class="nav-link" href="#wisdom-5"><span class="header-section-number">11.2</span> Wisdom</a></li>
<li>
<a class="nav-link" href="#justice-and-courage"><span class="header-section-number">11.3</span> Justice and Courage</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#election_age"><span class="header-section-number">11.3.1</span> election_age</a></li>
<li><a class="nav-link" href="#sex"><span class="header-section-number">11.3.2</span> sex</a></li>
<li><a class="nav-link" href="#election_age-and-sex"><span class="header-section-number">11.3.3</span> election_age and sex</a></li>
<li><a class="nav-link" href="#election_age-sex-and-election_agesex"><span class="header-section-number">11.3.4</span> election_age, sex and election_age*sex</a></li>
<li><a class="nav-link" href="#what-is-beta_0"><span class="header-section-number">11.3.5</span> What is \(\beta_0\)?</a></li>
<li><a class="nav-link" href="#state-election_age-sex-and-election_agesex"><span class="header-section-number">11.3.6</span> state, election_age, sex and election_age*sex</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#temperance-5"><span class="header-section-number">11.4</span> Temperance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#expected-values"><span class="header-section-number">11.4.1</span> Expected Values</a></li>
<li><a class="nav-link" href="#individual-predictions"><span class="header-section-number">11.4.2</span> Individual Predictions</a></li>
<li><a class="nav-link" href="#expectation-versus-individual-variation"><span class="header-section-number">11.4.3</span> Expectation versus individual variation</a></li>
<li><a class="nav-link" href="#testing"><span class="header-section-number">11.4.4</span> Testing</a></li>
</ul>
</li>
<li><a class="nav-link" href="#summary-6"><span class="header-section-number">11.5</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PPBDS/primer/blob/master/11-n-parameters.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PPBDS/primer/edit/master/11-n-parameters.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Preceptor’s Primer for Bayesian Big Data Science</strong>" was written by David Kane. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
